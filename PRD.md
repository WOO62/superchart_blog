# 슈퍼차트 블로그 상위노출 대시보드 PRD

## 프로젝트 개요
네이버 블로그 상위노출 모니터링 시스템의 대시보드 개발

## 목표
- 실시간 상위노출 현황 모니터링
- 캠페인별 성과 추적
- 매니저별 실적 관리
- 자동화된 데이터 수집 및 분석

## 주요 기능

### 1. 데이터 수집 시스템
- **MySQL 데이터 소스**: 읽기 전용 접근
- **Supabase 실시간 저장소**: 처리된 데이터 저장
- **하이브리드 모니터링**: GitHub Gist + 시간 기반 필터링
- **자동 동기화**: MySQL → Supabase 데이터 동기화

### 2. 대시보드 인터페이스

#### 2.1 통계 카드
- **오늘 등록**: 당일 등록된 리뷰 수
- **이번 달 게재**: 월간 게재 수
- **매니저별 실적**: 
  - 월간 실적 (성공률 포함)
  - 전체 실적 (성공률 포함)

#### 2.2 월별 실적 분석
- **접이식 UI**: 최근 6개월 데이터
- **월별 매니저 성과**: 각 매니저의 월별 게재 수 및 성공률
- **시각적 표현**: 테이블 형식의 깔끔한 UI

#### 2.3 실시간 모니터링 테이블
- **캠페인 정보**: 캠페인명, 매니저, 회사명
- **키워드 관리**: 타겟 키워드 표시
- **검색창 바로가기**: 네이버 블로그 검색 링크
  - 첫 번째 키워드로 자동 검색 URL 생성
  - 새 탭에서 검색 결과 확인 가능
- **성공 여부 추적**: 
  - Pending (대기)
  - Success (성공) 
  - Failure (실패)
  - 드롭다운 선택 즉시 자동 저장
- **순위 정보**: 1차/2차 체크 순위
  - 인라인 편집 가능
  - Enter키 또는 포커스 아웃 시 자동 저장
- **피드백 기능**: 실패 사유 기록
  - 구글 시트 스타일 입력
  - 실시간 저장

### 3. 데이터 처리 파이프라인

#### 3.1 리뷰 모니터링
```javascript
// review_monitor_hybrid.js
- MySQL에서 새 리뷰 조회
- GitHub Gist 처리 목록 관리
- Supabase 저장 (재시도 로직 포함)
- 중복 방지 메커니즘
```

#### 3.2 데이터 동기화
```javascript
// sync_missing_reviews.js
- 누락된 리뷰 자동 감지
- 배치 처리로 효율적 동기화
- proposition_id 매칭
```

#### 3.3 CSV 임포트
```javascript
// import_csv_fixed.js
- 타임스탬프 형식 변환 (YYYY-MM-DD HH:MM:SS → ISO 8601)
- NULL 값 처리
- 중복 체크
```

## 기술 스택

### Frontend
- **Next.js 14**: App Router 사용
- **React**: 컴포넌트 기반 UI
- **Tailwind CSS**: 스타일링
- **TypeScript**: 타입 안정성

### Backend
- **Node.js**: 서버 환경
- **MySQL2**: 데이터베이스 연결
- **Supabase Client**: 실시간 데이터베이스

### 배포
- **Vercel**: 자동 배포
- **GitHub Actions**: CI/CD

## 데이터베이스 스키마

### Supabase: exposure_tracking
```sql
- id: 자동 증가 ID
- proposition_id: MySQL Propositions.id 참조
- campaign_name: 캠페인명
- manager: 담당 매니저
- company_name: 회사명
- keywords: 타겟 키워드
- post_link: 블로그 포스트 URL
- blogger_id: 블로거 ID
- review_registered_at: 리뷰 등록 시간
- success_status: pending/success/failure
- first_check_rank: 1차 체크 순위
- second_check_rank: 2차 체크 순위
- feedback: 피드백 내용
- created_at: 생성 시간
- updated_at: 수정 시간
```

## 보안 규칙
- **MySQL**: 읽기 전용 접근
- **Supabase**: 서비스 역할 키 사용
- **환경 변수**: .env 파일로 관리
- **데이터 수정**: 사전 승인 필요

## 성과 지표
- **데이터 완전성**: 46% proposition_id 매칭
- **실시간성**: 5분 이내 데이터 반영
- **안정성**: 재시도 로직으로 99% 성공률

## 향후 개선 사항
- [ ] 상위노출 순위 자동 체크
- [ ] 키워드별 성과 분석
- [ ] 경쟁사 분석 기능
- [ ] 알림 시스템 구축
- [ ] 데이터 시각화 강화

## 변경 이력

### 2025-08-05
- **대시보드 UI/UX 개선**
  - 성공여부 드롭다운 선택 시 즉시 저장 및 UI 반영
  - 입력 필드 구글 시트 스타일로 단순화
  - 클릭 시 바로 편집, Enter/포커스 아웃 시 자동 저장
  - 실시간 UI 업데이트로 사용성 향상
  - **네이버 검색창 바로가기 추가**
    - 키워드별 블로그 검색 링크 자동 생성
    - 첫 번째 키워드로 검색 URL 구성

- **배포 환경 이슈 해결**
  - API 엔드포인트 통한 업데이트 방식 도입
  - 서버 측 Service Role Key 사용으로 RLS 우회
  - 클라이언트-서버 분리로 보안 강화

- **리뷰 모니터링 안정성 개선**
  - Supabase 저장 실패 시 Gist에 표시하지 않도록 수정
  - `supabaseSaved` 필드로 저장 성공 여부 추적
  - 실패한 리뷰 자동 재처리 로직 구현

- **데이터 무결성 강화**
  - 중복 체크 후 insert로 upsert 대체
  - 누락된 리뷰 복구 스크립트 추가
  - GitHub Actions 환경변수 설정 개선

### 2025-08-04
- 통계 카드 기능 추가
- 월별 실적 접이식 UI 구현
- 리뷰 모니터링 재시도 로직 개선
- CSV 임포트 기능 구현
- MySQL-Supabase 데이터 동기화 구현
- proposition_id 매칭 로직 추가

### 2025-08-03
- 초기 대시보드 구현
- 실시간 모니터링 테이블 구축
- GitHub Gist 연동 구현

## 문서 정보
- **작성일**: 2025-08-04
- **최종 수정**: 2025-08-05
- **버전**: 1.2.0